<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sipsd.flow.dao.flowable.IFlowableCalendarMapper">
	<select id="QueryCalendars"  parameterType="com.sipsd.flow.vo.flowable.holiday.SysCalendarVo" resultType="com.sipsd.flow.vo.flowable.holiday.SysCalendarVo">
		SELECT * FROM act_de_calendar where 1=1
		<if test="query.dateCode != null and query.dateCode != ''">
			and date_code = #{query.dateCode}
		</if>
		<if test="query.yearCode != null and query.yearCode != ''">
			and year_code = #{query.yearCode}
		</if>
		<if test="query.key != null and query.key != ''">
			and (solar_date LIKE CONCAT('%',#{query.key},'%') or
			lunar_date LIKE CONCAT('%',#{query.key},'%') or
			sexagenary_cycle LIKE CONCAT('%',#{query.key},'%') or
			chinese_zodiac LIKE CONCAT('%',#{query.key},'%') or
			solar_terms LIKE CONCAT('%',#{query.key},'%') or
			festivals LIKE CONCAT('%',#{query.key},'%'))
		</if>
	</select>


	<delete id="removeByDateCode"  parameterType="java.lang.String">
		delete FROM act_de_calendar where date_code = #{dateCode}
	</delete>

	<select id="queryStatutoryHolidays" parameterType="com.sipsd.flow.vo.flowable.holiday.SysStatutoryHolidayVo" resultType="com.sipsd.flow.vo.flowable.holiday.SysCalendarVo">
		SELECT * FROM act_de_calendar where 1=1
		<if test="query.holidaySign != null and query.holidaySign != ''">
			and holiday_sign = #{query.holidaySign}
		</if>
		<if test="query.holidayNotes != null and query.holidayNotes != ''">
		and holiday_notes = #{query.holidayNotes}
		</if>
	</select>

	<delete id="batchDeleteStatutoryHoliday" parameterType="java.lang.String">
		delete FROM act_de_calendar where date_code in
		<foreach item="item" collection="dateCodeList" separator="," open="(" close=")" index="">
			#{item}
		</foreach>
	</delete>

	<delete id="deleteCustomHolidayGroup" parameterType="java.lang.String">
		delete FROM act_de_calendar where group_code = #{groupCode}
	</delete>

	<delete id="deleteCustomHoliday" parameterType="java.lang.String">
		delete FROM act_de_calendar where group_code = #{groupCode} and date_code = #{dateCode}
	</delete>

	<delete id="batchDeleteCustomHoliday" parameterType="java.lang.String">
		delete FROM act_de_calendar where group_code = #{groupCode} and date_code in
		<foreach item="item" collection="dateCodeList" separator="," open="(" close=")" index="">
			#{item}
		</foreach>
	</delete>

	<select id="getAllHolidays"  parameterType="java.lang.String" resultType="com.sipsd.flow.vo.flowable.holiday.SysCalendarVo">
		select * from act_de_calendar where date between #{start} and #{end} and holiday_sign = 1
		<if test="groupCode != null and groupCode != ''">
			and group_code = #{groupCode}
		</if>
	</select>


	<select id="interval"  parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(*) from act_de_calendar where date_code BETWEEN  #{startDateCode} and #{endDateCode}
		and (if_weekend = 1 or holiday_sign =1)
	</select>

	<select id="totalDay"  parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(*) from act_de_calendar where date_code BETWEEN  #{startDateCode} and #{endDateCode}
	</select>


</mapper>